<?xml version="1.0"?>
<ocil xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://scap.nist.gov/schema/ocil/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <generator>
    <product_name>xccdf-create-ocil.xslt from SCAP Security Guide</product_name>
    <product_version>ssg: 0.1.47</product_version>
    <schema_version>2.0</schema_version>
    <timestamp>2019-11-28T04:48:17Z</timestamp>
  </generator>
  <questionnaires>
    <questionnaire id="container_horizon_csrf_cookie_secure_ocil">
      <title>Cross-Site Request Forgery Prevention: Enable CSRF_COOKIE_SECURE (containerized deployments)</title>
      <actions>
        <test_action_ref>container_horizon_csrf_cookie_secure_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="container_keystone_disable_user_account_days_inactive_ocil">
      <title>Set Maximum Inactivity Period</title>
      <actions>
        <test_action_ref>container_keystone_disable_user_account_days_inactive_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="container_keystone_lockout_duration_ocil">
      <title>Set Account Lockout Duration</title>
      <actions>
        <test_action_ref>container_keystone_lockout_duration_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="container_keystone_lockout_failure_attempts_ocil">
      <title>Set Maximum Number of Failed Authentication Attempts</title>
      <actions>
        <test_action_ref>container_keystone_lockout_failure_attempts_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="keystone_lockout_duration_ocil">
      <title>Set Account Lockout Duration</title>
      <actions>
        <test_action_ref>keystone_lockout_duration_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="keystone_lockout_failure_attempts_ocil">
      <title>Set Maximum Number of Failed Authentication Attempts</title>
      <actions>
        <test_action_ref>keystone_lockout_failure_attempts_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="keystone_disable_user_account_days_inactive_ocil">
      <title>Set Maximum Inactivity Period</title>
      <actions>
        <test_action_ref>keystone_disable_user_account_days_inactive_action</test_action_ref>
      </actions>
    </questionnaire>
    <questionnaire id="horizon_csrf_cookie_secure_ocil">
      <title>Cross-Site Request Forgery Prevention: Enable CSRF_COOKIE_SECURE (non-containerized deployments)</title>
      <actions>
        <test_action_ref>horizon_csrf_cookie_secure_action</test_action_ref>
      </actions>
    </questionnaire>
  </questionnaires>
  <test_actions>
    <boolean_question_test_action id="container_horizon_csrf_cookie_secure_action" question_ref="container_horizon_csrf_cookie_secure_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="container_keystone_disable_user_account_days_inactive_action" question_ref="container_keystone_disable_user_account_days_inactive_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="container_keystone_lockout_duration_action" question_ref="container_keystone_lockout_duration_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="container_keystone_lockout_failure_attempts_action" question_ref="container_keystone_lockout_failure_attempts_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="keystone_lockout_duration_action" question_ref="keystone_lockout_duration_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="keystone_lockout_failure_attempts_action" question_ref="keystone_lockout_failure_attempts_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="keystone_disable_user_account_days_inactive_action" question_ref="keystone_disable_user_account_days_inactive_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
    <boolean_question_test_action id="horizon_csrf_cookie_secure_action" question_ref="horizon_csrf_cookie_secure_question">
      <when_true>
        <result>PASS</result>
      </when_true>
      <when_false>
        <result>FAIL</result>
      </when_false>
    </boolean_question_test_action>
  </test_actions>
  <questions>
    <boolean_question id="container_horizon_csrf_cookie_secure_question">
      <question_text>Check the file /var/lib/config-data/puppet-generated/horizon/etc/openstack-dashboard/local_settings and ensure the
following line appears:
CSRF_COOKIE_SECURE True
      Is it the case that CSRF_COOKIE_SECURE is set to False?
      </question_text>
    </boolean_question>
    <boolean_question id="container_keystone_disable_user_account_days_inactive_question">
      <question_text>Run the following command to see what the maximum authentication
attempts is:

$ grep disable_user_account_days_inactive /var/lib/config-data/puppet-generated/keystone/etc/keystone/keystone.conf

If properly configured, the output should be:
disable_user_account_days_inactive = 
      Is it the case that disable_user_account_days_inactive is commented out or not configured properly?
      </question_text>
    </boolean_question>
    <boolean_question id="container_keystone_lockout_duration_question">
      <question_text>Run the following command to see what the account lockout
duration is:

$ grep lockout_duration /var/lib/config-data/puppet-generated/keystone/etc/keystone/keystone.conf

If properly configured, the output should be:
lockout_duration=
      Is it the case that lockout_duration is not configured properly?
      </question_text>
    </boolean_question>
    <boolean_question id="container_keystone_lockout_failure_attempts_question">
      <question_text>Run the following command to see what the maximum authentication
attempts is:

$ grep lockout_failure_attempts /var/lib/config-data/puppet-generated/keystone/etc/keystone/keystone.conf

If properly configured, the output should be:
lockout_failure_attempts=
      Is it the case that lockout_failure_attempts is commented out or not configured properly?
      </question_text>
    </boolean_question>
    <boolean_question id="keystone_lockout_duration_question">
      <question_text>Run the following command to see what the account lockout
duration is:

$ grep lockout_duration /etc/keystone/keystone.conf

If properly configured, the output should be:
lockout_duration=
      Is it the case that lockout_duration is not configured properly?
      </question_text>
    </boolean_question>
    <boolean_question id="keystone_lockout_failure_attempts_question">
      <question_text>Run the following command to see what the maximum authentication
attempts is:

$ grep lockout_failure_attempts /etc/keystone/keystone.conf

If properly configured, the output should be:
lockout_failure_attempts=
      Is it the case that lockout_failure_attempts is commented out or not configured properly?
      </question_text>
    </boolean_question>
    <boolean_question id="keystone_disable_user_account_days_inactive_question">
      <question_text>Run the following command to see what the maximum authentication
attempts is:

$ grep disable_user_account_days_inactive /etc/keystone/keystone.conf

If properly configured, the output should be:
disable_user_account_days_inactive = 
      Is it the case that disable_user_account_days_inactive is commented out or not configured properly?
      </question_text>
    </boolean_question>
    <boolean_question id="horizon_csrf_cookie_secure_question">
      <question_text>Check the file /etc/openstack-dashboard/local_settings and ensure the
following line appears:
CSRF_COOKIE_SECURE True
      Is it the case that CSRF_COOKIE_SECURE is set to False?
      </question_text>
    </boolean_question>
  </questions>
</ocil>
