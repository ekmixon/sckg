<fix-content system="urn:xccdf:fix:script:sh" xmlns="http://checklists.nist.gov/xccdf/1.1"><fix-group id="bash" system="urn:xccdf:fix:script:sh" xmlns="http://checklists.nist.gov/xccdf/1.1"><fix complexity="low" disruption="low" reboot="false" rule="file_owner_node_config" strategy="configure">

chown 0 /etc/origin/node/node-config.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_cni_conf" strategy="configure">

find /etc/cni/net.d/ -regex '^.*$' -exec chgrp 0 {} \;
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_etc_origin" strategy="configure">
chmod 0700 /etc/origin/
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_openvswitch" strategy="configure">

find /etc/origin/openvswitch/ -regex '^.*$' -exec chgrp 0 {} \;
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_openshift_kubeconfig" strategy="configure">

chgrp 0 /etc/origin/master/openshift-master.kubeconfig
</fix><fix rule="etcd_client_cert_auth">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_CLIENT_CERT_AUTH=' 'true' '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_api_server" strategy="configure">

chgrp 0 /etc/origin/node/pods/apiserver.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_etcd" strategy="configure">

chown 0 /etc/origin/node/pods/etcd.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_admin_conf" strategy="configure">

chgrp 0 /etc/origin/master/admin.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_openshift_node_service" strategy="configure">
chmod 0644 /etc/systemd/system/atomic-openshift-node.service
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_etc_origin" strategy="configure">

chgrp 0 /etc/origin/
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_openvswitch" strategy="configure">
find /etc/origin/openvswitch/ -regex '^.*$' -exec chmod 0644 {} \;
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_controller_manager" strategy="configure">

chgrp 0 /etc/origin/node/pods/controller.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_node_config" strategy="configure">

chgrp 0 /etc/origin/node/node-config.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_openvswitch" strategy="configure">

find /etc/origin/openvswitch/ -regex '^.*$' -exec chown 0 {} \;
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_openshift_node_client_crt" strategy="configure">

chgrp 0 /etc/origin/node/client-ca.crt
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_admin_conf" strategy="configure">

chown 0 /etc/origin/master/admin.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_node_kubeconfig" strategy="configure">

chown 0 /etc/origin/node/node.kubeconfig
</fix><fix rule="etcd_wal_dir">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_WAL_DIR=' '/var/lib/etcd/member/wal' '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_openshift_kubeconfig" strategy="configure">
chmod 0600 /etc/origin/master/openshift-master.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_cni_conf" strategy="configure">

find /etc/cni/net.d/ -regex '^.*$' -exec chown 0 {} \;
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_var_lib_etcd" strategy="configure">

chown 0 /var/lib/etcd/
</fix><fix rule="etcd_auto_tls">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_AUTO_TLS=' 'false' '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_api_server" strategy="configure">

chown 0 /etc/origin/node/pods/apiserver.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_admin_conf" strategy="configure">
chmod 0600 /etc/origin/master/admin.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_node_kubeconfig" strategy="configure">
chmod 0600 /etc/origin/node/node.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_var_lib_etcd" strategy="configure">
chmod 0700 /var/lib/etcd/
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_openshift_node_client_crt" strategy="configure">

chown 0 /etc/origin/node/client-ca.crt
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_scheduler_conf" strategy="configure">
chmod 0600 /etc/origin/master/scheduler.json
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_var_lib_etcd" strategy="configure">

chgrp 0 /var/lib/etcd/
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_node_kubeconfig" strategy="configure">

chgrp 0 /etc/origin/node/node.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_openshift_conf" strategy="configure">
chmod 0600 /etc/origin/master/master-config.yaml
</fix><fix rule="etcd_peer_auto_tls">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_PEER_AUTO_TLS=' 'false' '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_controller_manager" strategy="configure">

chown 0 /etc/origin/node/pods/controller.yaml
</fix><fix rule="etcd_unique_ca">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_TRUSTED_CA_FILE=' '/etc/etcd/ca.crt' '@CCENUM@' '%s=%s'
</fix><fix rule="etcd_max_wals">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_MAX_WALS=' '0' '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_etcd" strategy="configure">

chgrp 0 /etc/origin/node/pods/etcd.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_scheduler_conf" strategy="configure">

chown 0 /etc/origin/master/scheduler.json
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_openshift_conf" strategy="configure">

chown 0 /etc/origin/master/master-config.yaml
</fix><fix rule="etcd_peer_cert_file">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_PEER_CERT_FILE=' /etc/etcd/peer.crt '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_scheduler_conf" strategy="configure">

chgrp 0 /etc/origin/master/scheduler.json
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_controller_manager" strategy="configure">
chmod 0600 /etc/origin/node/pods/controller.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_etc_origin" strategy="configure">

chown 0 /etc/origin/
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_etcd" strategy="configure">
chmod 0600 /etc/origin/node/pods/etcd.yaml
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_openshift_node_service" strategy="configure">

chgrp 0 /etc/systemd/system/atomic-openshift-node.service
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_openshift_node_service" strategy="configure">

chown 0 /etc/systemd/system/atomic-openshift-node.service
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_owner_master_openshift_kubeconfig" strategy="configure">

chown 0 /etc/origin/master/openshift-master.kubeconfig
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_node_config" strategy="configure">
chmod 0600 /etc/origin/node/node-config.yaml
</fix><fix rule="etcd_peer_key_file">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_PEER_KEY_FILE=' /etc/etcd/peer.key '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_cni_conf" strategy="configure">
find /etc/cni/net.d/ -regex '^.*$' -exec chmod 0644 {} \;
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_openshift_node_client_crt" strategy="configure">
chmod 0600 /etc/origin/node/client-ca.crt
</fix><fix rule="etcd_peer_client_cert_auth">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_PEER_CLIENT_CERT_AUTH=' 'true' '@CCENUM@' '%s=%s'
</fix><fix rule="etcd_cert_file">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_CERT_FILE=' /etc/etcd/server.crt '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_groupowner_master_openshift_conf" strategy="configure">

chgrp 0 /etc/origin/master/master-config.yaml
</fix><fix rule="etcd_key_file">
<sub idref="function_replace_or_append" />
replace_or_append '/etc/etcd/etcd.conf' '^ETCD_KEY_FILE=' /etc/etcd/server.key '@CCENUM@' '%s=%s'
</fix><fix complexity="low" disruption="low" reboot="false" rule="file_permissions_master_api_server" strategy="configure">
chmod 0600 /etc/origin/node/pods/apiserver.yaml
</fix></fix-group></fix-content>